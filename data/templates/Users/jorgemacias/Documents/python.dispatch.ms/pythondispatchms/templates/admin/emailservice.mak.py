# -*- coding:utf-8 -*-
from mako import runtime, filters, cache
UNDEFINED = runtime.UNDEFINED
STOP_RENDERING = runtime.STOP_RENDERING
__M_dict_builtin = dict
__M_locals_builtin = locals
_magic_number = 10
_modified_time = 1555372041.778882
_enable_loop = True
_template_filename = '/Users/jorgemacias/Documents/python.dispatch.ms/pythondispatchms/templates/admin/emailservice.mak'
_template_uri = '/Users/jorgemacias/Documents/python.dispatch.ms/pythondispatchms/templates/admin/emailservice.mak'
_source_encoding = 'utf-8'
from markupsafe import escape_silent as escape
_exports = []


def render_body(context,**pageargs):
    __M_caller = context.caller_stack._push_frame()
    try:
        __M_locals = __M_dict_builtin(pageargs=pageargs)
        h = context.get('h', UNDEFINED)
        user = context.get('user', UNDEFINED)
        _ = context.get('_', UNDEFINED)
        __M_writer = context.writer()
        __M_writer('<style type="text/css">\n</style>\n<script>\n\n            function dateFmatter ( cellvalue, options, rowObject )\n            {\n                var utcDate=moment.utc(cellvalue,"YYYY-MM-DD h:mm:ss")\n                var localDate=moment(utcDate).local();\n                var formatdate = localDate.format("YYYY-MM-DD HH:mm:ss");\n                return formatdate;\n            }\n            function statusFmatter ( cellvalue, options, rowObject ){\n                html=cellvalue;\n                switch (cellvalue){\n                    case cellvalue="A":\n                        html = \'<center><span class="glyphicon glyphicon-search" style="color:blue"></span></center>\';\n                        break;\n                    case cellvalue="N":\n                        html = \'<center><span class="glyphicon glyphicon-remove" style="color:red"></span></center>\';\n                        break;\n                    case cellvalue="C":\n                        html = \'<center><span class="glyphicon glyphicon-ok" style="color:green"></span></center>\';\n                        break;\n                    case cellvalue="P":\n                        html = \'<center><span class="glyphicon glyphicon-time" style="color:sandybrown"></span></center>\';\n                        break;\n                }\n                return html;\n            }\n            function priorityFmatter ( cellvalue, options, rowObject )\n            {\n                html=cellvalue;\n\n                switch (cellvalue){\n\n                    case cellvalue=1:\n                        html=\'<center><div class="redsquare" style="text-align:center"> <img/> </div></center>\';\n                        break;\n                    case cellvalue=2:\n                        html=\'<center><div class="orangesquare"> <img/> </div></center>\';\n                        break;\n                    case cellvalue=3:\n                        html=\'<center><div class="yellowsquare"> <img/> </div></center>\';\n                        break;\n                    case cellvalue=4:\n                        html=\'<center><div class="greensquare"> <img/> </div></center>\'\n                        break;\n                    case cellvalue=5:\n                        html=\'<center><div class="bluesquare"> <img/> </div></center>\';\n                        break;\n                }\n                return html;\n            }\n            var c5Plates=\'\'\n            var grid_name_email = \'#jgGridEmail\';\n            var grid_pager_email= \'#listEmailListeners\';\n            var load_url=\'')
        __M_writer(escape(h.url()))
        __M_writer('/admin/loadEmailListener/?user=')
        __M_writer(escape(user))
        __M_writer("';\n            var update_url='")
        __M_writer(escape(h.url()))
        __M_writer('/admin/updateEmailListener/?user=')
        __M_writer(escape(user))
        __M_writer("';\n            //var header_container='")
        __M_writer(escape(_('Alerts')))
        __M_writer('\';\n            var addParams = {left: 0,width: window.innerWidth-700,top: 20,height: 255,url: update_url,mtype: \'GET\', closeAfterAdd: true,closeAfterEdit: true,closeAfterSearch:true}\n            var editParams = {left: 0,width: window.innerWidth-700,top: 20,height: 255,url: update_url,mtype: \'GET\',closeAfterAdd: true,closeAfterEdit: true,closeAfterSearch:true,modal: true,\n                    width: "500",\n                    editfunc: function (rowid) {\n                    }\n                };\n            var deleteParams = {left: 0,width: window.innerWidth-700,top: 20,height: 130,url: update_url,mtype: \'GET\',closeAfterAdd: true,closeAfterEdit: true,closeAfterSearch:true}\n            var viewParams = {left: 0,width: window.innerWidth-700,top: 20,height: 130,url: update_url,mtype: \'GET\',closeAfterAdd: true,closeAfterEdit: true,closeAfterSearch:true}\n            var searchParams = {top: 20,height: 130,width: "500",closeAfterAdd: true,mtype: \'GET\',closeAfterEdit: true,closeAfterSearch:true,url: update_url,modal: true, };\n            var grid = jQuery(grid_name_email);\n\n            $(document).ready(function () {\n                grid.jqGrid({\n                url: load_url,\n                datatype: \'json\',\n                mtype: \'GET\',\n                colNames: [\'')
        __M_writer(escape(_('Hidden')))
        __M_writer("', '")
        __M_writer(escape(_('Event ID')))
        __M_writer("', '")
        __M_writer(escape(_('Event Desc')))
        __M_writer("', '")
        __M_writer(escape(_('Client-Id')))
        __M_writer("', '")
        __M_writer(escape(_('Name')))
        __M_writer("', '")
        __M_writer(escape(_('IMEI')))
        __M_writer("', '")
        __M_writer(escape(_('Email')))
        __M_writer("', '")
        __M_writer(escape(_('Password')))
        __M_writer("', '")
        __M_writer(escape(_('SMTP Server')))
        __M_writer("','")
        __M_writer(escape(_('Port')))
        __M_writer("','")
        __M_writer(escape(_('Latitude')))
        __M_writer("','")
        __M_writer(escape(_('Longitude')))
        __M_writer('\'],\n                colModel: [\n                    {name: \'id\',index: \'id\', width: 5,align: \'left\',key:true,hidden: true, editable: true,edittype: \'text\',editrules: {required: false}},\n                    {name: \'event_id\',index: \'event_id\', width: 5, align: \'right\',hidden: false,editable: true, edittype: \'text\',editrules: {required: false}},\n                    {name: \'event_desc\',index: \'event_desc\',width: 10,align: \'right\',editable: true,edittype: \'text\',editrules: {required: true}},\n                    {name: \'client_id\', index: \'client_id\', width: 5,align: \'right\',hidden: false, editable: true, edittype: \'text\', formatter:statusFmatter, editrules: {required: true},search:false},\n                    {name: \'client_name\', index: \'client_name\', width: 10,align: \'right\',hidden: false, editable: true, edittype: \'text\', formatter:statusFmatter, editrules: {required: true},search:false},\n                    {name: \'imei\', index: \'imei\', width: 5,align: \'right\',hidden: false, editable: true, edittype: \'text\', formatter:priorityFmatter, editrules: {required: true},search:false},\n                    {name: \'email\',index: \'email\',width: 10,align: \'right\',hidden: false,editable: true,edittype: \'text\',editrules: {required: false}},\n                    {name: \'password\',index: \'password\',width: 5,align: \'right\',hidden: false,editable: true,edittype: \'text\',editrules: {required: false}},\n                    {name: \'smtp_server\',index: \'smtp_server\', width: 10, align: \'right\',hidden: false,editable: true, edittype: \'text\',editrules: {required: false}},\n                    {name: \'port\',index: \'port\',width: 5,align: \'right\',editable: true,edittype: \'text\',editrules: {required: true}},\n                    {name: \'latitude\',index: \'latitude\',width: 5,align: \'right\',editable: true,edittype: \'text\',editrules: {required: true}},\n                    {name: \'longitude\',index: \'longitude\',width: 5,align: \'right\',editable: true,edittype: \'text\',editrules: {required: true}},\n                ],\n                pager: jQuery(grid_pager_email),\n                rowNum: 10,\n                rowList: [10, 50, 100],\n                sortname: \'email\',\n                sortorder: "desc",\n                viewrecords: true,\n                autowidth: true,\n                height: 250,\n                //caption: header_container,\n            });\n            grid.jqGrid(\'navGrid\',grid_pager_email,{edit:false,add:false,del:true, search:false},\n                            editParams,\n                            addParams,\n                            deleteParams,\n                            searchParams,\n                            viewParams);\n            // add custom button\n            grid.navButtonAdd(grid_pager_email,\n                {\n                    buttonicon: "ui-icon-plus",\n                    title: "')
        __M_writer(escape(_('Add')))
        __M_writer('",\n                    caption: "')
        __M_writer(escape(_('Add')))
        __M_writer('",\n                    position: "first",\n                    onClickButton: addUserWindow\n                });\n            });\n            $.extend($.jgrid.nav,{alerttop:1});\n            function addUserWindow(){\n                var winHeight = 400; //Math.round(window.innerHeight * .50)\n                var winWidth = 810;//Math.round(window.innerWidth * .50)\n                var grid_name_email = \'jgGridEmai4Usersl\';\n                var pager_name = "jqGridPagerEmail4Users";\n                var grid_name_email_by_id = \'#\'+grid_name_email;\n                var pager_name_by_id = \'#\'+pager_name;\n                if ($(grid_name_email_by_id).length){\n                    $(grid_name_email_by_id).remove();\n                    $(pager_name_by_id).remove();\n                }\n                if ($("#AppForm").length){\n                    $("#AppForm").remove();\n                }\n                var newDiv = $(document.createElement(\'div\'));\n                var html=\'<div id="AppForm" title="Filter">\'\n                html=html+\'<table id="\'+grid_name_email+\'"></table> <div id="\'+pager_name+\'"> </div>\'\n                html=html+\'</div>\'\n                newDiv.html(html);\n\n                var createUsersSticky = newDiv.dialog({\n                    autoOpen: false,\n                    title: "Double click to select",\n                    height: winHeight - 20,\n                    width: winWidth,\n                    modal: true,\n                    close: function () {\n                    }\n                });\n                var grid = new jQuery(grid_name_email_by_id);\n                grid.jqGrid({\n                    url: \'')
        __M_writer(escape(h.url()))
        __M_writer('/admin/getClients4Email\',\n                    mtype: "GET",\n                    datatype: "json",\n                    page: 1,\n                    colModel: [\n                        {label: "User Name", name: \'username\', key: true, width: 150},\n                        {label: "Address", name: \'address\', width: 150},\n                        {label: "application_id", name: \'application_id\', width: 150,hidden:true},\n                        {label: "folio_sinube", name: \'folio_sinube\', width: 150,hidden:true},\n                        {label: "internal_id", name: \'internal_id\', width: 150,hidden:true}\n                    ],\n                    loadonce: true,\n                    viewrecords: true,\n                    width: 780,\n                    height: 250,\n                    rowNum: 10,\n                    pager: pager_name_by_id,\n                    ondblClickRow: function (rowId) {\n                        var rowData = jQuery(grid_name_email_by_id).getRowData(rowId);\n                        createUsersSticky.dialog("close");\n                        AddEmailService(rowData[\'application_id\'],rowData[\'folio_sinube\'],rowData[\'internal_id\'],rowData[\'username\']);\n                    },\n\n                });\n                grid.navGrid(pager_name_by_id, {\n                    search: true,\n                    add: false,\n                    edit: false,\n                    del: false,\n                    refresh: true\n                }, {}, {}, {}, {});\n\n                createUsersSticky.dialog("open");\n            }\n\n            function AddEmailService(client_id,imei,internal_id,application_name) {\n                var winHeight = 700; //Math.round(window.innerHeight * .50)\n                var winWidth = 800\n                if ($("#addEmailForm").length){\n                    $("#addEmailForm").remove();\n                }\n                var addEmailExpButtons = {\n                                    "')
        __M_writer(escape(_('Add')))
        __M_writer('": function() {\n                                        var expressionemail= encodeURIComponent($(\'#expressionemail\').val());\n                                        var expressionepasswd= encodeURIComponent($(\'#expressionpasswd\').val());\n                                        var expressionsmtp= encodeURIComponent($(\'#expressionsmtp\').val());\n                                        var expressionport= encodeURIComponent($(\'#expressionport\').val());\n                                        var expressioneventid= encodeURIComponent($(\'#expressioneventid\').val());\n                                        var expressioneventdesc= encodeURIComponent($(\'#expressioneventdesc\').val());\n                                        $.ajax({\n                                                type: "GET",\n                                                url:  \'')
        __M_writer(escape(h.url()))
        __M_writer('/admin/addEmaillistener\'+"?email="+expressionemail+"&password="+expressionepasswd+"&smtp="+expressionsmtp+"&port="+expressionport+"&client_id="+client_id+"&imei="+imei+"&internal_id="+internal_id+"&event_id="+expressioneventid+"&event_desc="+expressioneventdesc+"&client_name="+application_name,\n                                                contentType: "application/json; charset=utf-8",\n                                                data: { \'param\':\'gaugeParameters\' },\n                                                success: function(data) {\n                                                    // data.value is the success return json. json string contains key value\n                                                     $(\'#jgGridEmail\').trigger( \'reloadGrid\' );\n                                                },\n                                                error: function() {\n                                                     $.alert("Error accessing /admin/addGlobalExp", { autoClose:false,});\n                                                    return true;\n                                                },\n                                                complete: function() {\n                                                }\n                                                });\n                                            $(\'#emailListenerForm\')[0].reset();\n                                            addUserTriggerDialog.dialog( "close" );\n\n\n                                    },\n                                    "')
        __M_writer(escape(_('Close')))
        __M_writer('": function() {\n                                        $(\'#emailListenerForm\')[0].reset();\n                                        addUserTriggerDialog.dialog( "close" );\n                                    }\n                            };\n                var newDiv = $(document.createElement(\'div\'));\n                var info=\'<style type="text/css"> .container { width: 500px; clear: both; }.container input { width: 100%; clear: both; } </style>\'\n                info=info+\'<div class="container" id="addEmailForm" title="Filter"><form id="emailListenerForm">\'\n                info=info+\'<br>Event ID:</label> <input id="expressioneventid" name="expressioneventid" type="number"></textarea>\'\n                info=info+\'<br>Event Desc:</label> <input id="expressioneventdesc" name="expressioneventdesc" type="text"></textarea>\'\n                info=info+\'<br>Email:<input type="text" id="expressionemail" name="expressionemail"></textarea>\'\n                info=info+\'<br>Password:<input type="text" id="expressionpasswd" name="expressionpasswd"></textarea>\'\n                info=info+\'<br>SMTP Server:<input type="text" id="expressionsmtp" name="expressionsmtp" value="imap.gmail.com"></textarea>\'\n                info=info+\'<br>SMTP Port:</label> <input id="expressionport" name="expressionport" value="993" type="number"></textarea>\'\n                info=info+\'<br/></form></div>\'\n                newDiv.html(info);\n                var addUserTriggerDialog = newDiv.dialog({\n                    autoOpen: false,\n                    title:\'Add email listener parameters\',\n                    height: winHeight-100,\n                    width: winWidth-200,\n                    modal: true,\n                    buttons: addEmailExpButtons,\n                    close: function() {\n                        //$(\'#emailListenerForm\')[0].reset();\n                        //form[ 0 ].reset();\n                        //allFields.removeClass( "ui-state-error" );\n                    }\n                 });\n                addUserTriggerDialog.data(\'rowId\',1);\n                addUserTriggerDialog.dialog( "open" );\n            }\n            // STOMP\n            var emaillistenerclient = Stomp.client(\'')
        __M_writer(escape(h.stompServer()))
        __M_writer('\');\n            emaillistenerclient.debug=null;\n            var email_listener_connect_callback = function() {\n                emaillistenerclient.subscribe("/topic/emaillistener", email_listener_subscribe_callback);\n                // called back after the client is connected and authenticated to the STOMP server\n              };\n            var email_listener_error_callback = function(error) {\n            };\n            var email_listener_subscribe_callback = function(message) {\n\n                var msg = message.body;\n                var payload = msg.split(\'|\');\n                var command = payload[0];\n                var data = payload[1];\n                switch (command) {\n                        case \'RELOAD\':\n                            $("#jgGridListeners").trigger( \'reloadGrid\' );\n                            break;\n                        case \'NEW\':\n                            $("#jgGridListeners").trigger( \'reloadGrid\' );\n                            $.alert("Listener has been trigger, now you can assign data", { autoClose:true,type: \'success\',});\n                            bell.play();\n                            break;\n                        case \'MSG\':\n                            $.alert(data, { autoClose:false,type: \'success\',});\n                            bell.play();\n                            break;\n                }\n              };\n            //emaillistenerclient.connect(\'')
        __M_writer(escape(h.whoami()))
        __M_writer("', '")
        __M_writer(escape(h.password()))
        __M_writer("', listener_connect_callback, listener_error_callback, '/');\n            var stompUser='")
        __M_writer(escape(h.stompUser()))
        __M_writer("';\n            var stompPass='")
        __M_writer(escape(h.stompPassword()))
        __M_writer('\';\n            emaillistenerclient.connect(stompUser, stompPass, email_listener_connect_callback, email_listener_error_callback, \'/\');\n            </script>\n</div>\n    <!-- page start-->\n    <!-- Hidden POP UP Start-->\n\n    <!-- Hidden POP UP End-->\n<div id="noteContent" title="')
        __M_writer(escape(_('Basic dialog')))
        __M_writer('">\n</div>\n    <!-- JQGRID table start-->\n    <table style="width:100%">\n    <table id="jgGridEmail" class="scroll" cellpadding="0" cellspacing="0"></table>\n    <div id="listEmailListeners" class="scroll" style="text-align:center;"></div>\n    <div id="listPsetcolsListener+e" class="scroll" style="text-align:center;"></div>\n    </table>\n    <br>\n\n  <!-- page end-->')
        return ''
    finally:
        context.caller_stack._pop_frame()


"""
__M_BEGIN_METADATA
{"source_encoding": "utf-8", "line_map": {"17": 0, "25": 1, "26": 57, "27": 57, "28": 57, "29": 57, "30": 58, "31": 58, "32": 58, "33": 58, "34": 59, "35": 59, "36": 76, "37": 76, "38": 76, "39": 76, "40": 76, "41": 76, "42": 76, "43": 76, "44": 76, "45": 76, "46": 76, "47": 76, "48": 76, "49": 76, "50": 76, "51": 76, "52": 76, "53": 76, "54": 76, "55": 76, "56": 76, "57": 76, "58": 76, "59": 76, "60": 111, "61": 111, "62": 112, "63": 112, "64": 149, "65": 149, "66": 191, "67": 191, "68": 200, "69": 200, "70": 219, "71": 219, "72": 252, "73": 252, "74": 281, "75": 281, "76": 281, "77": 281, "78": 282, "79": 282, "80": 283, "81": 283, "82": 291, "83": 291, "89": 83}, "uri": "/Users/jorgemacias/Documents/python.dispatch.ms/pythondispatchms/templates/admin/emailservice.mak", "filename": "/Users/jorgemacias/Documents/python.dispatch.ms/pythondispatchms/templates/admin/emailservice.mak"}
__M_END_METADATA
"""
